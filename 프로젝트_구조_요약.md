# Fanbase Platform 백엔드 프로젝트 구조 요약

## 생성 완료

✅ **총 359개의 Python 파일 자동 생성 완료**
✅ **67개 테이블 전체 구현**
✅ **Docker Compose 설정 완료**

## 프로젝트 파일 구성

### 핵심 파일 (9개)
- `app/main.py` - FastAPI 메인 애플리케이션 (모든 라우터 등록)
- `app/config.py` - 환경 설정
- `app/database.py` - PostgreSQL AsyncSession 설정
- `app/dependencies.py` - 공통 의존성 (인증 등)
- `app/core/security.py` - JWT, 비밀번호 해싱
- `app/core/cache.py` - Redis 캐시 클라이언트
- `app/core/storage.py` - Cloudflare R2 스토리지
- `app/common/base_crud.py` - Base CRUD 클래스
- `README.md` - 프로젝트 문서

### 모듈별 테이블 (67개)

#### 1. auth (9개)
- users
- user_settings
- profile
- user_addresses
- user_devices
- login_logs
- deleted_users
- global_blacklist
- subscription_blacklist

#### 2. artist (5개)
- artists
- artist_categories
- artist_category_map
- artist_social_links
- managers

#### 3. subscription (3개)
- subscriptions
- subscription_plans
- subscription_cancellations

#### 4. content (11개)
- posts, post_images, post_comments, post_stats
- images
- artist_images, artist_image_comments, artist_image_stats
- artist_videos, artist_video_comments, artist_video_stats

#### 5. search (2개)
- calendar_searches
- saved_search_filters

#### 6. chat (7개)
- chat_rooms
- chat_messages
- chat_images
- chat_videos
- chat_read_receipts
- chat_pins
- chat_reports

#### 7. payment (3개)
- payments
- payment_methods
- payment_refunds

#### 8. event (3개)
- events
- event_participants
- event_attendance

#### 9. shop (4개)
- products
- product_images
- orders
- order_items

#### 10. notification (5개)
- notifications
- notification_settings
- notification_templates
- scheduled_notifications
- system_logs

#### 11. like (4개)
- fan_likes
- fan_recommendations
- artist_post_likes
- artist_post_recommendations

#### 12. stats (4개)
- artist_content_stats
- artist_chat_stats
- subscriber_content_stats
- subscriber_chat_stats

#### 13. moderation (2개)
- moderation_models
- content_moderation

#### 14. admin (5개)
- faq
- banners
- system_messages
- notices
- error_logs

## 각 테이블 구조 (4개 파일)

모든 67개 테이블에 대해 다음 파일들이 자동 생성됨:

1. **models.py** - SQLAlchemy 모델
   - ERD 기반 컬럼 정의
   - ForeignKey 관계 설정
   - 인덱스 및 제약조건

2. **schemas.py** - Pydantic 스키마
   - Base, Create, Update, Response 스키마
   - List 스키마 (페이지네이션)

3. **crud.py** - CRUD 작업
   - BaseCRUD 상속
   - 생성, 조회, 업데이트, 삭제(status='D'), 카운트

4. **router.py** - FastAPI 라우터
   - POST / - 생성
   - GET /{id} - 단건 조회
   - GET / - 목록 조회 (페이지네이션)
   - PATCH /{id} - 업데이트
   - DELETE /{id} - 삭제 (soft delete)

## 삭제 메커니즘

- 모든 삭제는 `status='D'`로 변경
- 실제 데이터는 유지됨 (복구 가능)
- 조회 시 `status != 'D'` 자동 필터링

## 기술 스택

### Backend
- FastAPI
- SQLAlchemy (Async)
- PostgreSQL
- Redis
- Elasticsearch (검색 구현 예정)

### Storage
- Cloudflare R2 (S3 compatible)

### Authentication
- JWT
- OAuth (Google, Kakao, Naver)
- bcrypt 비밀번호 해싱

### Deployment
- Docker
- Docker Compose
- Nginx (Reverse Proxy)

## 실행 방법

### 로컬 개발
```bash
# 의존성 설치
pip install -r requirements.txt

# 서버 실행
uvicorn app.main:app --reload
```

### Docker 배포
```bash
# 전체 스택 실행
docker-compose up -d

# 백엔드만 재시작
docker-compose restart backend
```

## API 문서

서버 실행 후:
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

## 환경 변수

`.env.example` 파일 참고:
- DATABASE_URL
- REDIS_URL
- ELASTICSEARCH_URL
- CLOUDFLARE_R2_* (Access Key, Secret, Bucket, Endpoint)
- JWT_SECRET
- OAUTH_* (Google, Kakao, Naver)

## 다음 단계

1. ✅ 프로젝트 구조 생성
2. ✅ 모든 모델 생성
3. ✅ CRUD 및 라우터 생성
4. ⬜ Alembic 마이그레이션 실행
5. ⬜ Elasticsearch 인덱스 설정
6. ⬜ OAuth 인증 구현
7. ⬜ 파일 업로드 API 구현
8. ⬜ WebSocket 채팅 구현
9. ⬜ 단위 테스트 작성

